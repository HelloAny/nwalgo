<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- UIkit CSS -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/uikit@3.7.1/dist/css/uikit.min.css"
    />

    <!-- UIkit JS -->
    <script src="https://cdn.jsdelivr.net/npm/uikit@3.7.1/dist/js/uikit.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/uikit@3.7.1/dist/js/uikit-icons.min.js"></script>
    <title>Document</title>
    <style>
      #app {
        width: 80%;
        margin-left: 10%;
        margin-top: 50px;
        overflow: hidden;
        overflow-x: scroll;
      }
    </style>
  </head>
  <body>
    <nav class="uk-navbar-container" uk-navbar>
      <div class="uk-navbar-left">
        <ul class="uk-navbar-nav">
          <li class="uk-active"><a href="#">主页</a></li>
        </ul>
      </div>
    </nav>
    <div style="text-align: center; margin-top: 30px">
      <input
        class="uk-input"
        type="text"
        placeholder="first DNA/RNA"
        style="width: 500px"
      />
      <input
        class="uk-input"
        type="text"
        placeholder="second DNA/RNA"
        style="width: 500px"
      />
      <button class="uk-button uk-button-primary">compile</button>
    </div>

    <div id="app"></div>
  </body>
  <script>
    (function () {
      const TARGET_FORM = "FORM";

      function isNumber(param) {
        return typeof param === "number";
      }

      class Node {
        width = 70;
        height = 70;
        // args Bound [row, col]
        constructor(idx, value, bound, target) {
          this.index = idx;
          this.value = value;
          this.bound = bound;
          this.target = target;
        }

        _initFrameAssets(pathPass) {
          const [firIdx, sedIdx] = pathPass;
          if (isNumber(firIdx) && isNumber(sedIdx)) {
            const [isRight, isBottom] = this._isBound(firIdx, sedIdx);
            return {
              value: this.value,
              isTarget: this.target,
              isRight,
              isBottom
            };
          }
        }
        _isBound(rightLine, bottomLine) {
          const [row, col] = this.bound;
          if (rightLine >= row - 1 && bottomLine >= col - 1) {
            return [true, true];
          } else if (rightLine >= row - 1 && bottomLine < col - 1) {
            return [false, true];
          } else if (rightLine < row - 1 && bottomLine >= col - 1) {
            return [true, false];
          } else {
            return [false, false];
          }
        }
        render() {
          const { value, isRight, isBottom, isTarget } = this._initFrameAssets(
            this.index
          );
          return [
            `<div style="border: 1px solid black; border-bottom: ${
              isBottom ? "1px solid black" : "0px"
            };border-right: ${isRight ? "1px solid black" : "0px"};background:${
              isTarget ? "#eeeeee" : "white"
            };width: ${this.width}px;height: ${
              this.height
            }px;text-align:center;line-height:${
              this.height
            }px;font-size:24px">`,
            `${value}`,
            `</div>`
          ].join("");
        }
      }

      const bundle = [
        [
          {
            idx: [0, 0],
            value: "a",
            bound: [2, 2],
            isTarget: true
          },
          {
            idx: [0, 1],
            value: "b",
            bound: [2, 2],
            isTarget: false
          }
        ],
        [
          {
            idx: [1, 0],
            value: "c",
            bound: [2, 2],
            isTarget: true
          },
          {
            idx: [1, 1],
            value: "d",
            bound: [2, 2],
            isTarget: true
          }
        ]
      ];
      const NodeItem = new Node([1, 0], "s", [2, 2], true);

      function tapMerge() {
        let validColItemList = [];
        bundle.forEach((ctx, index) => {
          const colItem = ctx.map(item => {
            const { idx, value, bound, isTarget } = item;
            const renderItem = new Node(idx, value, bound, isTarget);
            return renderItem.render();
          });
          validColItemList[index] = "<div style='display:flex'>" + colItem.join("") + "</div>";
        }, "");
        return "<div>" + validColItemList.join("") + "</div>";
      }
      const renderContent = tapMerge();

      document.getElementById("app").innerHTML = renderContent;
    })();
  </script>
</html>
